<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>cencalvm: libsrc/query/README File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.3 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">cencalvm</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<h1>libsrc/query/README File Reference</h1>  </div>
</div>
<div class="contents">

<p>Interface for querying USGS central CA velocity model.  
<a href="#_details">More...</a></p>
<table class="memberdecls">
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Interface for querying USGS central CA velocity model. </p>
<h2><a class="anchor" id="Database"></a>
Database</h2>
<p>See <a class="el" href="structcencalvm_1_1storage_1_1PayloadStruct.html" title="Data stored in velocity model database.">cencalvm::storage::PayloadStruct</a> for a list of the data (and the order in which it is returned by default).</p>
<h3><a class="anchor" id="Units"></a>
Units</h3>
<p>SI units are used in the database and its interface. See the documentation of the query routines for specific units of the arguments to each routine.</p>
<h2><a class="anchor" id="extendedmodel"></a>
Enabling use of the extended (regional) model</h2>
<p>Use of the extended model is disabled by default. To enable use of the extended model in queries simply set the filename of the extended model using <a class="el" href="classcencalvm_1_1query_1_1VMQuery.html#a37b3d171c8a5a45175b969d0e3d39da6" title="Set the database filename for the extended model.">cencalvm::query::VMQuery::filenameExt()</a> in C++, <a class="el" href="cvmquery_8h.html#ac923c7cf023fcf72b49a5b0ad0f5d6f4" title="Set the extended database filename.">cencalvm_filenameExt()</a> in C, or <a class="el" href="f77vmquery_8h.html#a927aa5cbc0097bad6a0c59531ddbb55c" title="Set the extended database filename.">cencalvm_filenameext_f()</a> in Fortran. You can also change the size of the cache used in queries of the extended model using <a class="el" href="classcencalvm_1_1query_1_1VMQuery.html#a6613a6cbc3db04e63fa635522103b529" title="Set size of cache during queries in the extended model.">cencalvm::query::VMQuery::cacheSizeExt()</a> in C++, <a class="el" href="cvmquery_8h.html#a3d93331140fa70c741ecbb1819dd0f25" title="Set size of cache during queries of extended database.">cencalvm_cacheSizeExt()</a> in C, or <a class="el" href="f77vmquery_8h.html#a0604a16c2578e80cf1b9a0e9be01dc11" title="Set size of cache during queries.">cencalvm_cachesizeext_f()</a> in Fortran.</p>
<h2><a class="anchor" id="Applications"></a>
Applications</h2>
<h3><a class="anchor" id="cencalvminfo"></a>
cencalvminfo</h3>
<p>This application dumps the metadata, database schema, and number of octants in an etree database to stdout.</p>
<h2><a class="anchor" id="Examples"></a>
Examples</h2>
<p>The data directory contains sample input and output for the examples. The output can be compared to that generated on your machine to make sure the example ran properly.</p>
<p>The cpp, c, and f77 directories contain the examples of how to query the database from C++, C, and Fortran, respectively. See <a class="el" href="examples_2query_2README.html">examples/query/README </a> for more information.</p>
<h2><a class="anchor" id="Querying"></a>
routines</h2>
<p>Documentation for the query routines for each language are contained in the header files. Pay special attention to the default query parameters.</p>
<h3><a class="anchor" id="queryTypes"></a>
Query types</h3>
<p>The etree database is a fully populated etree, meaning data is stored at the leaves of the tree as well as in the interior. The different levels in the etree correspond to different spatial resolutions. The lower an octant is in the etree, the smaller the spatial volume associated with the octant. In other words, values at the different levels of the etree correspond to material properties at different spatial resolutions, for example the P wave speed on a scale of 25 meters versus the P wave speed on a scale of 400 meters. The values at the interior octants at each level are the arithmetic means of the values of its children. The queries for the elevation of topography and bathymetry are computed indirectly using the the depth from the free surface and the coordinates of the octant returned in a search. Thus, the resolution depends on the depth of the point used in the query and the type of query (MAXRES, FIXEDRES, or WAVERES).</p>
<dl class="note"><dt><b>Note:</b></dt><dd>Because averaging fault block and zone values is not meaningful, the fault block and zone values are set to -999 in the interior octants.</dd>
<dd>
In the database, the value for Vs in water is -999. In order to prevent nonphysical values for solid material near the solid/water interface, mixing of solid and water material properties is not permitted and solid material properties take precedence. In other words, if an interior octant has both children with water properties and children wich solid material properties, the solid material properties will be averaged and the water properties will be ignored.</dd></dl>
<h4><a class="anchor" id="setQueryType"></a>
Setting the query type</h4>
<p>The query routine assigns values from the Etree database for a given location depending on the query type.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>Resolution in the discussion that follows refers to the vertical resolution which is finer than the horizontal resolution.</dd></dl>
<h4><a class="anchor" id="maxres"></a>
MAXRES query</h4>
<p>When the query type is set to MAXRES, then the query routines will use values at the maximum resolution available. The query values will be set to -999.0 if the etree was not populated with data at that location even if averaged values are available; this happens when one queries at locations above topography or the water surface. If you want averaged values, use one of the other query types.</p>
<h4><a class="anchor" id="fixedres"></a>
FIXEDRES query</h4>
<p>When the query type is set to FIXEDRES, values at the requested resolution will be used even if the database contains values at a higher resolution. This prevents aliasing the model for queries at a uniform spatial resolution. The requested resolution is set with <a class="el" href="classcencalvm_1_1query_1_1VMQuery.html#acad492c2f8478ca99a772e60228667f0" title="Set query resolution.">cencalvm::query::VMQuery::queryRes()</a> in C++, <a class="el" href="cvmquery_8h.html#a998e56b2b92ed093231e1d5342da0002" title="Set query resolution.">cencalvm_queryRes()</a> in C, and <a class="el" href="f77vmquery_8h.html#af3ad30417c9f2e62850eb80e2e089cbc" title="Set query resolution.">cencalvm_queryres_f()</a> in Fortran.</p>
<h4><a class="anchor" id="waveres"></a>
WAVERES query</h4>
<p>When the query type is set to WAVERES, the requested resolution is the wavelength for shear waves at a given minimum period. The query routine first finds the maximum resolution available and traverses up the tree until the resolution is no greater than the requested resolution. This prevents aliasing the model for queries at variable spatial resolution but uniform resolution with respect to the wavelength of shear waves at a given period. The requested resolution is set by passing the minimum period as an argument to <a class="el" href="classcencalvm_1_1query_1_1VMQuery.html#acad492c2f8478ca99a772e60228667f0" title="Set query resolution.">cencalvm::query::VMQuery::queryRes()</a> in C++, <a class="el" href="cvmquery_8h.html#a998e56b2b92ed093231e1d5342da0002" title="Set query resolution.">cencalvm_queryRes()</a> in C, and <a class="el" href="f77vmquery_8h.html#af3ad30417c9f2e62850eb80e2e089cbc" title="Set query resolution.">cencalvm_queryres_f()</a> in Fortran.</p>
<h3><a class="anchor" id="squashing"></a>
Squashing topography/bathymetry</h3>
<p>There are two settings that permit the velocity structure to be adjusted so that the top surface is aligned with sea level. The default query behavior does NOT use squashing. Use cencalvm::query:::VMQuery::squash() to turn on squashing of topography. Squashing, by default, is limited to elevations above -2 km. That is, the geometry of the model above an elevation of -2 km (2 km below sea level) is moved up/down so that that ground surface is at sea level. Below an elevation of -2 km, the geometry of the seismic velocity model is retained. The elevation for this extent of squashing can be set using the second argument in <a class="el" href="classcencalvm_1_1query_1_1VMQuery.html#a99ddc17d520b3a05f40d5abeea4c6477" title="Set squashed topography/bathymetry flag and minimum elevation of squashing.">cencalvm::query::VMQuery::squash()</a>.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>The elevation of the ground surface used in squashing topography is found by performaing a MAXRES query for the elevation of topography at the location of the velocity model query. Thus, the resolution of the elevation used to squash topography is coarser for points deep in the model (provided the location lies above the depth extent of squashing).</dd>
<dd>
In the database, the value for Vs in water is -999. In order to prevent nonphysical values for solid material near the solid/water interface, mixing of solid and water material properties is not permitted and solid material properties take precedence. In other words, if an interior octant has both children with water properties and children wich solid material properties, the solid material properties will be averaged and the water properties will be ignored.</dd></dl>
<h3><a class="anchor" id="f77notes"></a>
Fortran 77 notes</h3>
<ul>
<li><b><a class="el" href="f77vmquery_8h.html#a6fc4b6c445dfeadb11c10db79de9d69b" title="Create velocity model query object.">cencalvm_createquery_f()</a></b> </li>
</ul>
<p>The argument to <a class="el" href="f77vmquery_8h.html#a6fc4b6c445dfeadb11c10db79de9d69b" title="Create velocity model query object.">cencalvm_createquery_f()</a> is used to store the address of the handle to the underlying C++ object. It is ABSOLUTELY CRITICAL that the number of bytes associated with this variable match the size of a C/C++ pointer on the system where the routines are compiled. On 32-bit and 64-bit systems, the variables will generally be a 4 byte integer (integer*4) and an 8 byte integer (integer*8), respectively.</p>
<ul>
<li>No Fortran 77 binding for <a class="el" href="cvmquery_8h.html#a8aa9db2b4f73475609425c8bba1485e9" title="Set values to be returned by queries.">cencalvm_queryVals()</a></li>
</ul>
<p>Because arrays of strings cannot be passed from Fortran to C++ in a standard manner, there is no Fortran 77 binding for <a class="el" href="cvmquery_8h.html#a8aa9db2b4f73475609425c8bba1485e9" title="Set values to be returned by queries.">cencalvm_queryVals()</a>. Instead, you must accept the default behavior in which all values are returned. </p>
</div></div>
<hr class="footer"/><address class="footer"><small>Generated on Thu May 26 2011 12:51:09 for cencalvm by&#160;
<a href="http://www.stack.nl/~dimitri/doxygen/">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </small></address>
</body>
</html>
